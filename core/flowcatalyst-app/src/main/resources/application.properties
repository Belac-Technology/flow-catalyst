# Full Stack Application Configuration
quarkus.application.name=flowcatalyst
quarkus.banner.enabled=false

# Logging Configuration - Dev: readable logs (not JSON)
%dev.quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n
%dev.quarkus.log.console.json.enabled=false
%dev.quarkus.log.level=INFO
%dev.quarkus.log.category."tech.flowcatalyst".level=DEBUG

# Logging Configuration - Prod: JSON structured logs
%prod.quarkus.log.console.format=json
%prod.quarkus.log.console.json.pretty-print=false
%prod.quarkus.log.level=INFO
%prod.quarkus.log.console.json.additional-field."service.name".value=flowcatalyst
%prod.quarkus.log.console.json.additional-field."service.version".value=${quarkus.application.version:1.0.0-SNAPSHOT}
%prod.quarkus.log.console.json.additional-field."environment".value=${ENVIRONMENT:production}

# Message Router Configuration
message-router.enabled=true
message-router.queue-type=SQS
message-router.sync-interval=5m
message-router.max-pools=2000
message-router.pool-warning-threshold=1000

# Message Router Consumer Configuration
message-router.sqs.max-messages-per-poll=10
message-router.sqs.wait-time-seconds=20
message-router.activemq.receive-timeout-ms=1000
message-router.metrics.poll-interval-seconds=5

# REST Client Configuration
# Full URL including path, e.g., http://localhost:8000/api/config
quarkus.rest-client.message-router-config.url=${MESSAGE_ROUTER_CONFIG_URL:http://localhost:8080/api/config}
quarkus.rest-client.message-router-config.scope=jakarta.inject.Singleton

# SQS Configuration (when using SQS)
quarkus.sqs.endpoint-override=${SQS_ENDPOINT_OVERRIDE:}
quarkus.sqs.aws.region=${AWS_REGION:eu-west-1}
quarkus.sqs.aws.credentials.type=default

# Dev profile - LocalStack local SQS
%dev.quarkus.sqs.endpoint-override=http://localhost:4566
%dev.quarkus.sqs.aws.region=eu-west-1
%dev.quarkus.sqs.aws.credentials.type=static
%dev.quarkus.sqs.aws.credentials.static-provider.access-key-id=test
%dev.quarkus.sqs.aws.credentials.static-provider.secret-access-key=test

# ActiveMQ Configuration (when using ACTIVEMQ)
activemq.broker.url=${ACTIVEMQ_BROKER_URL:tcp://localhost:61616}
activemq.username=${ACTIVEMQ_USERNAME:admin}
activemq.password=${ACTIVEMQ_PASSWORD:admin}

# PostgreSQL Configuration
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=${POSTGRES_USER:flowcatalyst}
quarkus.datasource.password=${POSTGRES_PASSWORD:flowcatalyst}
quarkus.datasource.jdbc.url=${POSTGRES_URL:jdbc:postgresql://localhost:5432/flowcatalyst}

# Hibernate Configuration
quarkus.hibernate-orm.log.sql=false

# Dev profile - PostgreSQL local
%dev.quarkus.datasource.username=flowcatalyst
%dev.quarkus.datasource.password=flowcatalyst
%dev.quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/flowcatalyst
%dev.quarkus.hibernate-orm.log.sql=true

# Flyway Configuration
quarkus.flyway.migrate-at-start=true
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.baseline-version=0
quarkus.flyway.locations=classpath:db/migration

# HTTP Auth - Enable protected paths from message-router
# Platform's OIDC handles the actual authentication
quarkus.http.auth.permission.protected.enabled=true

# =============================================================================
# Event Processor Configuration
# =============================================================================

# Enable the event processor in all-in-one mode
event-processor.enabled=true
event-processor.concurrency=10
event-processor.batch-max-size=100
event-processor.batch-max-wait-ms=100

# MongoDB settings (shared with platform)
event-processor.database=flowcatalyst
event-processor.source-collection=events
event-processor.projection-collection=events_read

# Hot standby for event processor (optional)
# Set standby.enabled=true and configure Redis if running multiple instances
# standby.enabled=false
# standby.lock-key=event-processor-primary-lock
# standby.lock-ttl-seconds=30

